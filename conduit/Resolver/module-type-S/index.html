<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>S (conduit.Resolver.S)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">conduit</a> &#x00BB; <a href="../index.html">Resolver</a> &#x00BB; S</nav><h1>Module type <code>Resolver.S</code></h1><p>Module type for a <span class="xref-unresolved" title="unresolved reference to &quot;resolution&quot;"><span>resolver</span></span> that can map URIs to concrete <span class="xref-unresolved" title="unresolved reference to &quot;endp&quot;"><span>endpoints</span></span> that stream connections can be established with.</p></header><dl><dt class="spec type" id="type-io"><a href="#type-io" class="anchor"></a><code><span class="keyword">type</span> <span>+'a io</span></code></dt><dd><p>Abstract type of the cooperative threading library used, normally defined via the <code>IO</code> module type</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>State handle for a running resolver</p></dd></dl><div><div class="spec include"><div class="doc"><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> Ppx_sexp_conv_lib.Sexpable.S <span class="keyword">with</span> <span class="keyword">type</span> <a href="../index.html#module-type-S">S</a>.t := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec value" id="val-t_of_sexp"><a href="#val-t_of_sexp" class="anchor"></a><code><span class="keyword">val</span> t_of_sexp : Sexplib0__.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Sexplib0__.Sexp.t</code></dt></dl></details></div></div></div></div></div></div><dl><dt class="spec type" id="type-svc"><a href="#type-svc" class="anchor"></a><code><span class="keyword">type</span> svc</code></dt><dd><p>Abstract type for a service entry, which maps a URI scheme into a protocol handler and TCP port</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-sexp_of_svc"><a href="#val-sexp_of_svc" class="anchor"></a><code><span class="keyword">val</span> sexp_of_svc : <a href="index.html#type-svc">svc</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-svc_of_sexp"><a href="#val-svc_of_sexp" class="anchor"></a><code><span class="keyword">val</span> svc_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-svc">svc</a></code></dt></dl></div></div></div><dl><dt class="spec type" id="type-rewrite_fn"><a href="#type-rewrite_fn" class="anchor"></a><code><span class="keyword">type</span> rewrite_fn</code><code> = <a href="index.html#type-svc">svc</a> <span>&#45;&gt;</span> Uri.t <span>&#45;&gt;</span> <span><a href="../../Conduit/index.html#type-endp">Conduit.endp</a> <a href="index.html#type-io">io</a></span></code></dt><dd><p>A rewrite function resolves a <a href="index.html#type-svc"><span>service</span></a> and a URI into a concrete endpoint.</p></dd></dl><dl><dt class="spec type" id="type-service_fn"><a href="#type-service_fn" class="anchor"></a><code><span class="keyword">type</span> service_fn</code><code> = string <span>&#45;&gt;</span> <span><span><a href="index.html#type-svc">svc</a> option</span> <a href="index.html#type-io">io</a></span></code></dt><dd><p>A service function maps the string (such as <code>http</code> or <code>ftp</code>) from a URI scheme into a <a href="index.html#type-svc"><span>service</span></a> description that includes enough metadata about the service to subsequently <a href="index.html#type-rewrite_fn"><span>resolve</span></a> it into an <span class="xref-unresolved" title="unresolved reference to &quot;endp&quot;"><span>endpoint</span></span>.</p></dd></dl><dl><dt class="spec value" id="val-(++)"><a href="#val-(++)" class="anchor"></a><code><span class="keyword">val</span> (++) : <a href="index.html#type-service_fn">service_fn</a> <span>&#45;&gt;</span> <a href="index.html#type-service_fn">service_fn</a> <span>&#45;&gt;</span> <a href="index.html#type-service_fn">service_fn</a></code></dt><dd><p><code>f ++ g</code> is the composition of the service functions <code>f</code> and <code>g</code>.</p></dd></dl><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : <span>?&#8288;service:<a href="index.html#type-service_fn">service_fn</a></span> <span>&#45;&gt;</span> <span>?&#8288;rewrites:<span><span>(string * <a href="index.html#type-rewrite_fn">rewrite_fn</a>)</span> list</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>init ?service ?rewrites</code> will initialize the resolver and return a state handler. The <a href="index.html#type-service_fn"><span>service</span></a> argument should contain the system-specific resolution mechanism for URI schemas.</p><p>The <code>rewrites</code> argument can optionally override a subset of the URI domain name with the given <a href="index.html#type-rewrite_fn"><code>rewrite_fn</code></a> to permit custom resolution rules. For example, a rewrite rule for &quot;.xen&quot; would let the rewrite function resolve hostnames such as &quot;foo.xen&quot; into a shared memory channel for the &quot;foo&quot; virtual machine.</p></dd></dl><dl><dt class="spec value" id="val-add_rewrite"><a href="#val-add_rewrite" class="anchor"></a><code><span class="keyword">val</span> add_rewrite : <span>host:string</span> <span>&#45;&gt;</span> <span>f:<a href="index.html#type-rewrite_fn">rewrite_fn</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_rewrite ~host f t</code> will add to the <code>t</code> resolver the <code>f</code> rewrite rule for all the domain names that shortest-prefix match <code>host</code></p></dd></dl><dl><dt class="spec value" id="val-set_service"><a href="#val-set_service" class="anchor"></a><code><span class="keyword">val</span> set_service : <span>f:<a href="index.html#type-service_fn">service_fn</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-service"><a href="#val-service" class="anchor"></a><code><span class="keyword">val</span> service : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-service_fn">service_fn</a></code></dt><dd><p><code>service t</code> is the function which is called when trying to resolve a hostname with <code>t</code>.</p></dd></dl><dl><dt class="spec value" id="val-resolve_uri"><a href="#val-resolve_uri" class="anchor"></a><code><span class="keyword">val</span> resolve_uri : <span>?&#8288;rewrites:<span><span>(string * <a href="index.html#type-rewrite_fn">rewrite_fn</a>)</span> list</span></span> <span>&#45;&gt;</span> <span>uri:Uri.t</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../../Conduit/index.html#type-endp">Conduit.endp</a> <a href="index.html#type-io">io</a></span></code></dt><dd><p><code>resolve_uri ?rewrites ~uri t</code> will use <code>t</code> to resolve the <code>uri</code> into a concrete endpoint. Any <code>rewrites</code> that are passed in will be overlayed on the existing rules within the <code>t</code> resolver, but not otherwise modify it.</p></dd></dl></div></body></html>